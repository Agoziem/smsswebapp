{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
  <meta charset="utf-8">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/St Marks Logo.png' %}">
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/St Marks Logo.png' %}">
  <link rel="icon" type="image/png" sizes="48x48" href="{% static 'images/St Marks Logo.png' %}">
  
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'wine-red': '#3b0505',
            'cream-color': '#ffffff'
          }
        }
      }
    }
  </script>
  
  <!-- DaisyUI -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- PDF Generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  
  <title>SMSS Omagba - Result Portal</title>
  
  <style>
    .display1 { font-family: 'League Spartan', sans-serif; font-weight: 700; }
    .display2 { font-family: 'Josefin Sans', sans-serif; font-weight: 600; }
    .sideline_text { color: #6b7280; font-size: 0.875rem; }
    
    @media print {
      .no-print { display: none !important; }
      .print-only { display: block !important; }
      body { background: white !important; }
    }
  </style>
  
  <script>
    var user = '{{request.user}}'
    function getToken(name) {
      var cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
          var cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    var csrftoken = getToken('csrftoken')
  </script>
</head>

<body class="bg-base-200">
  <!-- Navigation Bar -->
  <div class="navbar bg-base-100 shadow-lg fixed top-0 z-50 no-print">
    <div class="navbar-start">
      <div class="dropdown">
        <div tabindex="0" role="button" class="btn btn-ghost lg:hidden">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16"></path>
          </svg>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52">
          <li><a href="{% url 'home' %}">Home</a></li>
          <li><a href="/#About">About Us</a></li>
          <li><a href="{% url 'Teachers_portal:Teachers_dashboard' %}">Teachers Portal</a></li>
          <li>
            <details>
              <summary>Students Section</summary>
              <ul class="p-2">
                <li><a href="{% url 'Result_portal:classes' %}">Result Portal</a></li>
                <li><a href="{% url 'CBT:Cbt' %}">CBT</a></li>
              </ul>
            </details>
          </li>
        </ul>
      </div>
      <a href="{% url 'home' %}" class="btn btn-ghost">
        <img src="{% static 'images/St Marks Logo.png' %}" alt="SMSS Logo" class="h-10 w-auto">
      </a>
    </div>
    
    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal px-1">
        <li>
          <details>
            <summary>Home</summary>
            <ul class="p-2 bg-base-100 rounded-t-none">
              <li><a href="/#About">About Us</a></li>
              <li><a href="/#Management">Teachers</a></li>
              <li><a href="/#Management">Management</a></li>
              <li><a href="/#review">Reviews</a></li>
              <li><a href="/#contact">Contact us</a></li>
              <li><a href="/#FAQ">FAQ</a></li>
            </ul>
          </details>
        </li>
        <li><a href="#">Articles</a></li>
        <li><a href="{% url 'Teachers_portal:Teachers_dashboard' %}">Teachers Portal</a></li>
        <li>
          <details>
            <summary>Students Section</summary>
            <ul class="p-2 bg-base-100 rounded-t-none">
              <li><a href="{% url 'Result_portal:classes' %}">Result Portal</a></li>
              <li><a href="{% url 'CBT:Cbt' %}">CBT</a></li>
            </ul>
          </details>
        </li>
      </ul>
    </div>
    
    <div class="navbar-end">
      <div class="dropdown dropdown-end">
        <div tabindex="0" role="button" class="btn btn-ghost btn-circle">
          <i class="fas fa-user text-lg"></i>
        </div>
        <ul tabindex="0" class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52">
          {% if request.user.is_superuser %}
          <li><a href="{% url 'activation_side' %}">Activation</a></li>
          {% endif %}
          <li><a href="/admin" target="_blank">Admin</a></li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Hidden Inputs for Chart Data -->
  <input id="labels" type="hidden" value="{{labels}}">
  <input id="data" type="hidden" value="{{data}}">

  <!-- Print Container -->
  <div id="container_result" class="mt-16 lg:mt-20">
    <!-- School Logo -->
    <section class="py-6 bg-base-100">
      <div class="flex justify-center">
        <img src="{% static 'images/St Marks Logo.png' %}" alt="School Logo" class="h-24 w-auto">
      </div>
    </section>

    <!-- School Name and Result Header -->
    <section class="py-6 bg-base-100">
      <div class="text-center">
        <h4 class="text-2xl font-bold text-primary mb-4">St Marks Standard Secondary School Omagba (Termly Result)</h4>
        <h1 class="text-4xl font-bold display1 text-wine-red mb-6">{{student_details.student_name}}</h1>
        <div class="flex justify-center gap-2">
          <div class="h-1 w-16 bg-wine-red rounded"></div>
          <div class="h-1 w-10 bg-wine-red/60 rounded"></div>
        </div>
      </div>
    </section>

    <!-- Student Details -->
    <section class="py-6 bg-base-200">
      <div class="container mx-auto px-4">
        <div class="card bg-base-100 shadow-xl">
          <div class="card-body">
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <div><span class="font-bold">Class:</span> {{ studentClass.Class }}</div>
                <div><span class="font-bold">Term:</span> {{ Result_details.Term }}</div>
                <div><span class="font-bold">Session:</span> {{ Result_details.AcademicSession }}</div>
                <div><span class="font-bold">Total Score:</span> {{ Result_details.TotalScore }}</div>
              </div>
              <div class="space-y-2">
                <div><span class="font-bold">Average:</span> {{ Result_details.Average|floatformat:2 }}</div>
                <div><span class="font-bold">Position:</span> {{ Result_details.Position }}</div>
                <div><span class="font-bold">Number in Class:</span> {{ Result_details.Totalnumber }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Results Table -->
    <section class="py-6 bg-base-200">
      <div class="container mx-auto px-4">
        <div class="card bg-base-100 shadow-xl">
          <div class="card-body p-0">
            <div class="overflow-x-auto">
              <table class="table table-zebra">
                <thead class="bg-wine-red text-base-100">
                  <tr>
                    <th class="text-center">S/N</th>
                    <th>Subjects</th>
                    <th class="text-center">Test (5)</th>
                    <th class="text-center">Project (5)</th>
                    <th class="text-center">Mid Term Test (20)</th>
                    <th class="text-center">Ass (5)</th>
                    <th class="text-center">Note (5)</th>
                    <th class="text-center">CA (40)</th>
                    <th class="text-center">Exam (60)</th>
                    <th class="text-center">Total (100)</th>
                    <th class="text-center">Grade</th>
                    <th class="text-center">Position</th>
                    <th>Remark</th>
                  </tr>
                </thead>
                <tbody>
                  {% for data in Results %}
                  <tr class="hover">
                    <td class="text-center font-medium">{{forloop.counter}}</td>
                    <td class="font-medium">{{data.Subject}}</td>
                    <td class="text-center">{{data.FirstTest}}</td>
                    <td class="text-center">{{data.FirstAss}}</td>
                    <td class="text-center">{{data.MidTermTest}}</td>
                    <td class="text-center">{{data.SecondAss}}</td>
                    <td class="text-center">{{data.SecondTest}}</td>
                    <td class="text-center font-semibold">{{data.CA}}</td>
                    <td class="text-center font-semibold">{{data.Exam}}</td>
                    <td class="text-center font-bold text-primary">{{data.Total}}</td>
                    <td class="text-center">
                      <span class="badge badge-primary">{{data.Grade}}</span>
                    </td>
                    <td class="text-center">{{data.SubjectPosition}}</td>
                    <td class="text-sm">{{data.Remark}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Charts & QR Code -->
    <section class="py-6 bg-base-100">
      <div class="container mx-auto px-4">
        <div class="grid lg:grid-cols-2 gap-8 items-center">
          <div class="flex justify-center">
            <div class="w-full max-w-md">
              <canvas id="mybarChart" class="w-full h-80"></canvas>
            </div>
          </div>
          <div class="flex justify-center">
            <div class="card bg-base-100 shadow-lg">
              <div class="card-body items-center text-center">
                <h3 class="card-title text-lg mb-4">Verification QR Code</h3>
                <img src="{% static 'images/Result_QRCode.png' %}" class="w-44 h-auto" alt="QR Code">
                <p class="text-sm text-base-content/70 mt-2">Scan to verify result authenticity</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Annual Results Section -->
    {% if Annual_Result %}
    <section class="py-6 bg-base-200">
      <div class="container mx-auto px-4">
        <div class="text-center mb-8">
          <h2 class="text-3xl font-bold display1 text-wine-red mb-4">Annual Result</h2>
          <div class="flex justify-center gap-2">
            <div class="h-1 w-16 bg-wine-red rounded"></div>
            <div class="h-1 w-10 bg-wine-red/60 rounded"></div>
          </div>
        </div>

        <div class="card bg-base-100 shadow-xl mb-6">
          <div class="card-body">
            <div class="grid md:grid-cols-2 gap-6">
              <div class="space-y-2">
                <div><span class="font-bold">Session:</span> {{ AnnualStudent.academicsession }}</div>
                <div><span class="font-bold">Total Score:</span> {{ AnnualStudent.TotalScore|floatformat:2 }}</div>
                <div><span class="font-bold">Average:</span> {{ AnnualStudent.Average|floatformat:2 }}</div>
              </div>
              <div class="space-y-2">
                <div><span class="font-bold">Position:</span> {{ AnnualStudent.Position }}</div>
                <div><span class="font-bold">Number in Class:</span> {{ AnnualStudent.Totalnumber }}</div>
                <div><span class="font-bold">Principal's Verdict:</span> {{ AnnualStudent.Verdict }}</div>
              </div>
            </div>
          </div>
        </div>
          <span class="fw-bold">Total score :</span> {{ AnnualStudent.TotalScore|floatformat:2 }}<br>
          <span class="fw-bold">Average :</span> {{ AnnualStudent.Average|floatformat:2 }}<br>
          <span class="fw-bold">Position :</span> {{ AnnualStudent.Position }}<br>
          <span class="fw-bold">Number in Class :</span> {{ AnnualStudent.Totalnumber }}<br>
          <span class="fw-bold">Principal's Verdict :</span>
          {{ AnnualStudent.Verdict }}
        </div>
      </div>
    </section>

    <section class="px-3 pt-2">
      <div class="result_table">
        <table>
          <thead>
            <tr>
              <th scope="col">S/N</th>
              <th scope="col">Subjects</th>
              <th scope="col">1st Term</th>
              <th scope="col">2nd Term</th>
              <th scope="col">3rd Term</th>
              <th scope="col">Total</th>
              <th scope="col">Average</th>
              <th scope="col">Grade</th>
              <th scope="col">Position</th>
              <th scope="col">Remark</th>
            </tr>
          </thead>
          <tbody>
            {% for data in AnnualResult %}
            <tr>
              <td>{{forloop.counter}}</td>
              <td>{{data.Subject}}</td>
              <td>{{data.FirstTermTotal}}</td>
              <td>{{data.SecondTermTotal}}</td>
              <td>{{data.ThirdTermTotal}}</td>
              <td>{{data.Total|floatformat}} </td>
              <td>{{data.Average|floatformat:2}}</td>
              <td>{{data.Grade}}</td>
              <td>{{data.SubjectPosition}}</td>
              <td>{{data.Remark}}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </section>
    
  {% endif %}


  </div>
  <!--end of print ////////////////////////////////////////////////////////////// -->

  <section class=" ms-5 my-3 ">
    <div class="container px-2 px-md-5  mb-5">

      {% if isTermNewsletter %}
        <a href="{{ TermNewsletter.NewsletterURL }}" class="btn btn-outline-primary"
          download="{{ TermNewsletter.NewsletterURL }}">
          {{ TermNewsletter.currentTerm.term }} Newsletter
          <i class="bi bi-download ms-2"></i>
        </a>
        {% endif %}


      <a id="result_btn" class="btn btn-primary">
        Save as Pdf
        <span class="spinner-border spinner-border-sm d-none ms-1" role="status" aria-hidden="true"></span>
      </a>

      <a id="redgrad2" href="{% url 'home' %}" class="btn btn-info"> Back to Home
        <i class="fa fa-house ms-1"></i>
      </a>
    </div>
  </section>

<footer class="footer">
    <div class="footer_link row justify-content-between pb-4 px-5">
      <div class="col-10 col-sm-8 col-md-4 pe-1 pe-sm-4 pe-md-5">
        <div id="sub_form_alert_success" class="alert alert-success" style="display: none;">
          <i class="bi bi-check-circle-fill mx-2 text-success h5"></i>
          <div>
            Your email has been sent successfully!
          </div>
        </div>
  
        <div id="sub_form_alert_danger" class="alert alert-danger" style="display:none;">
          <i class="fa-solid fa-triangle-exclamation mx-2 text-danger h5"></i>
          <div>
            An error occurred while sending your message.
          </div>
        </div>
        <form id="sub_form">
          <h5>Subscribe to our newsletter</h5>
          <p>Monthly digest of whats new and exciting from us.</p>
          <div class="d-flex w-100 gap-2">
            <label for="newsletter1" class="visually-hidden">Email address</label>
            <input id="newsletter1" type="email" class="form-control" placeholder="Email address" name="email" required>
            <button class="btn btn-secondary" value="submit" type="submit">Subscribe</button>
          </div>
        </form>
        <ul class="list-unstyled d-flex mt-3">
          <li><a class="link-dark" href="#"><i class="fa-brands fa-facebook" style="font-size: 22px;"></i></a>
          </li>
          <li class="ms-3"><a class="link-dark" href="#"><i class="fa-brands fa-instagram"
                style="font-size: 22px;"></i></a></li>
          <li class="ms-3"><a class="link-dark" href="#"><i class="fa-brands fa-whatsapp"
                style="font-size: 22px;"></i></a></li>
          <li class="ms-3"><a class="link-dark" href="#"><i class="fa-brands fa-twitter" style="font-size: 22px;"></i></a>
          </li>
        </ul>
      </div>
  
      <div class="col-5 col-sm-3 col-md-2 py-3 pt-md-0">
        <h5>Quick links</h5>
        <ul class="nav flex-column">
          <li class="nav-item mb-2"><a href="{% url 'home' %}" class="nav-link p-0">Home</a></li>
          <li class="nav-item mb-2"><a href="/#About" class="nav-link p-0">About</a></li>
          <li class="nav-item mb-2"><a href="/Accounts/" class="nav-link p-0">Management</a></li>
          <li class="nav-item mb-2"><a href="/#Teachers" class="nav-link p-0">Teachers</a></li>
          <li class="nav-item mb-2"><a href="/#gallery" class="nav-link p-0">Photogallery</a></li>
          <li class="nav-item mb-2"><a href="/#FAQ" class="nav-link p-0">FAQ</a></li>
        </ul>
      </div>
  
      <div class="col-5 col-md-2 py-3 pt-md-0">
        <h5>Articles</h5>
        <ul class="nav flex-column">
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Health</a></li>
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Politics</a></li>
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Science</a></li>
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Arts</a></li>
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Literature</a></li>
        </ul>
      </div>
  
      <div class="col-5 col-md-2">
        <h5>Students portal</h5>
        <ul class="nav flex-column">
          <li class="nav-item mb-2"><a href="{% url 'Result_portal:classes' %}" class="nav-link p-0">Results</a>
          </li>
          <li class="nav-item mb-2"><a href="{% url 'Payment_portal:initiate_payment' %}"
              class="nav-link p-0">Payments</a></li>
          <li class="nav-item mb-2"><a href="{% url 'Elibrary:subjects' %}" class="nav-link p-0">E-library</a>
          </li>
          <li class="nav-item mb-2"><a href="{% url 'Admission_form:initiate_payment' %}"
              class="nav-link p-0">Admission_form</a></li>
          <li class="nav-item mb-2"><a href="{% url 'Teachers_portal:Teachers_dashboard' %}" class="nav-link p-0">Teacher
              Portal</a></li>
          <li class="nav-item mb-2"><a href="#" class="nav-link p-0">Entrance Exam Result</a></li>
        </ul>
      </div>
  
  
    </div>
  
    <div class="sub_footer d-flex justify-content-center align-items-center py-4">
      <div>
        <p class="my-0 text-center">&copy; 2022 SMSS Omagba, inst . All rights reserved.</p>
        <p class="my-0 text-center">designed by Gozzy designs and development</p>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script src="{% static 'js/swiper-bundle.min.js' %}"></script>
  <script src="{% static 'js/Student_Portal/result.js' %}"></script>
</body>

</html>