{% extends 'base.html' %}
{% load static %}
{% block content%}
{% include 'main_navbar.html' %}
<style >
  .modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
  background-color: #fffef6;
  margin: 250px auto; /* 15% from the top and centered */
  padding: 30px 20px 20px 20px;
  width: 300px; /* Could be more or less, depending on screen size */
  text-align: center;
}

/* Close Button */
/* Close Button */
.close {
  color: #3b0505;
  font-size: 35px;
  font-weight: bold;
  position: absolute;
  top: 0;
  right: 10px;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

</style>


<!-- Upload Successful modal -->
<div id="modal" class="modal">
  <div class="modal-content d-flex">
    <p class="me-3"><i class="fas fa-check-circle text-success me-2"></i> File submitted successfully!</p>
    <div><span class="close">&times;</span></div>   
  </div>
</div>
<!-- Main page starts here -->
<section class="pt-5">
  <h1 class="px-3 mt-3 text-center" style="font-size: 30px;">STUDENT RESULT MANAGEMENT SYSTEM</h1>
  <div class="container">
    <div class=" row justify-content-center align-items-center p-3">
      <div class="col-md">

        <!-- Excel file Upload table  -->
        <table class="table table-bordered">
          <thead>
            <tr>
              <th scope="col">Upload Result Excel files</th>
          </thead>
          <tbody>
            <tr>
              <td>
                <form id="myForm" method="post" enctype="multipart/form-data">
                  <div class="form-group mb-3 mt-2">
                    <input type="file" class="form-control" id="myFile" name="myFile" required>
                  </div>
                  <div class="d-flex justify-content-center">
                    <button type="submit" class="btn btn-primary w-75" id="uploadButton">Upload</button>
                  </div>                 
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="col-md">
        <table class="table table-bordered">
          <!-- Table to Create Pin -->
          <thead>
            <tr>
              <th scope="col">create Students pin </th>
          </thead>
          <tbody>
            <tr>
              <td class="d-flex flex-column align-items-center">
                <a href="{% url 'Pin' %}" class="btn btn-primary">create Students pin</a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="container p-3">
    <table class="table table-bordered">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Termly Students </th>
          <th scope="col">Termly Results</th>
          <th scope="col">Annual Students</th>
          <th scope="col">Annual Results</th>

      </thead>
      <tbody>
        <tr>
          <th scope="row">Jss1</th>
          <td><a href="{% url 'Result_portal:juniorstudents1' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresult1' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorstudentsannual1' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresultannual1' %}" class="btn btn-primary btn-sm">create</a></td>
        </tr>

        <tr>
          <th scope="row">Jss2</th>
          <td><a href="{% url 'Result_portal:juniorstudents2' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresult2' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorstudentsannual2' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresultannual2' %}" class="btn btn-primary btn-sm">create</a></td>
        </tr>
        <tr>
          <th scope="row">Jss3</th>
          <td><a href="{% url 'Result_portal:juniorstudents3' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresult3' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorstudentsannual3' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:juniorresultannual3' %}" class="btn btn-primary btn-sm">create</a></td>

        </tr>
        <tr>
          <th scope="row">Ss1</th>
          <td><a href="{% url 'Result_portal:seniorstudents1' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresult1' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorstudentsannual1' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresultannual1' %}" class="btn btn-primary btn-sm">create</a></td>
        </tr>

        <tr>
          <th scope="row">Ss2</th>
          <td><a href="{% url 'Result_portal:seniorstudents2' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresult2' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorstudentsannual2' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresultannual2' %}" class="btn btn-primary btn-sm">create</a></td>
        </tr>

        <tr>
          <th scope="row">Ss3</th>
          <td><a href="{% url 'Result_portal:seniorstudents3' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresult3' %}" class="btn btn-warning btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorstudentsannual3' %}" class="btn btn-sm">create</a></td>
          <td><a href="{% url 'Result_portal:seniorresultannual3' %}" class="btn btn-primary btn-sm">create</a></td>
        </tr>

      </tbody>
    </table>

  </div>
</section>

<script>
  // Ajax Excel Excel Upload Script 
  const form = document.getElementById('myForm');
  const uploadButton = document.getElementById('uploadButton');
  const modal = document.getElementById('modal');
  const span = document.getElementsByClassName('close')[0];
  
  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    uploadFile(formData);
  });
  
  function uploadFile(formData) {
    uploadButton.innerHTML = 'Upload in progress...';
    const xhr = new XMLHttpRequest();
    xhr.open('POST', "{% url 'upload' %}");
    xhr.setRequestHeader('X-CSRFToken', csrftoken);
    xhr.upload.addEventListener('progress', (e) => {
      if (e.lengthComputable) {
        // const percent = Math.round((e.loaded / e.total) * 100);
        // progressBar.style.width = percent + '%';
        // progressBar.setAttribute('aria-valuenow', percent);
      }
    });
    xhr.addEventListener('load', () => {
      uploadButton.innerHTML = 'Upload another file';
      modal.style.display = "block";
      form.reset()
    });
    xhr.addEventListener('error', () => {
      alert('Upload failed!');
    });
    xhr.send(formData);
  }
  
  span.onclick = function() {
    modal.style.display = "none";
  };
  
  window.onclick = function(event) {
      modal.style.display = "none";
    }
  
  
  // ///////////////////////////////////////////////////////////
  </script>
{% include 'main_footer.html' %}
{% endblock %}